var Graph=function(t,i){this.canvas=t,this.dataset=i,this.points=[],this.position={x:0,y:0},this.min=0,this.max=0,this.highlight="",this.point={},this.ratio=1,this.realWidth,this.init(),this.convert(),this.listen(),this.draw()};Graph.prototype.init=function(){this.canvas.getContext("2d");this.makeHighRes()},Graph.prototype.listen=function(){var t=this;this.canvas.addEventListener("mousemove",function(i){t.position=t.getMousePos(i),t.draw()},!1),this.canvas.addEventListener("touchmove",function(i){t.position=t.getMousePos(i),t.draw()},!1),this.canvas.addEventListener("touchstart",function(i){t.position=t.getMousePos(i),t.draw()},!1)},Graph.prototype.convert=function(){var t=0,i=0;this.dataset.forEach(function(s){s.x>t&&(t=s.x),s.y>i&&(i=s.y)});var s=t,e=i;this.dataset.forEach(function(t){t.x<s&&(s=t.x),t.y<e&&(e=t.y)});var o=Math.abs(t-s),a=Math.abs(i-e),n=this.canvas.width-20,h=20;if(this.min=h,this.max=n,o>a)var r=t,c=s;else var r=i,c=e;console.log(n+" "+h);var v=r-c,l=n-h,p=this;this.dataset.forEach(function(t){var i={x:(t.x-c)*l/v+h,y:p.canvas.width-20-((t.y-c)*l/v+h)};p.points.push(i)}),console.log(this.points)},Graph.prototype.draw=function(t){function i(t,i){for(var s=i[0],e=Math.abs(t-s.x),o=0;o<i.length;o++){var a=Math.abs(t-i[o].x);a<e&&(e=a,s=i[o])}return s}var s=this.canvas,e=s.getContext("2d"),o=0;this.realWidth/this.points.length;e.clearRect(0,0,s.width,s.height),e.fillStyle="#FFF",e.fillRect(0,0,s.width,s.height),e.fillStyle="#FFF",e.beginPath(),e.save();e.moveTo(this.points[0].x,this.points[0].y);for(var o=0;o<this.points.length;o++)e.lineTo(this.points[o].x,this.points[o].y);if(e.strokeStyle="#00C853",e.lineWidth=2*this.ratio,e.stroke(),e.restore(),this.position.x){e.save(),e.beginPath(),e.moveTo(this.position.x,0),e.lineTo(this.position.x,s.height),e.strokeStyle="#777777",e.stroke(),e.restore(),e.save(),e.beginPath();var i=i(this.position.x,this.points);e.arc(i.x,i.y,5,0,2*Math.PI,!1),e.fillStyle="#00C853",e.fill()}},Graph.prototype.getMousePos=function(t){t.preventDefault();var i=this.canvas.getBoundingClientRect();return window.event.touches?{x:(window.event.touches[0].pageX-i.left)*this.ratio,y:(window.event.touches[0].pageY-i.top)*this.ratio}:{x:(t.clientX-i.left)*this.ratio,y:(t.clientY-i.top)*this.ratio}},Graph.prototype.makeHighRes=function(){var t=this.canvas.getContext("2d"),i=window.devicePixelRatio||1,s=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,e=i/s;if(i!==s){var o=this.canvas.width,a=this.canvas.height;this.canvas.width=Math.round(o*e),this.canvas.height=Math.round(a*e),this.canvas.style.width=o+"px",this.canvas.style.height=a+"px",t.save(),t.scale(e,e),this.ratio=e,t.restore()}};